# üìã –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–æ–∫ (Leads)

## –í–µ—Ä—Å–∏—è: 1.0
**–î–∞—Ç–∞:** 30.12.2025

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
2. [Endpoint –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏](#endpoint-–¥–ª—è-—Å–æ–∑–¥–∞–Ω–∏—è-–∑–∞—è–≤–∫–∏)
3. [–¢–∏–ø—ã –∑–∞—è–≤–æ–∫](#—Ç–∏–ø—ã-–∑–∞—è–≤–æ–∫)
4. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–∑–∞–ø—Ä–æ—Å–∞)
5. [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
6. [–ü–ª–∞–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏](#–ø–ª–∞–Ω-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
7. [–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫](#–æ–±—Ä–∞–±–æ—Ç–∫–∞-–æ—à–∏–±–æ–∫)
8. [FAQ](#faq)

---

## üéØ –û–±–∑–æ—Ä

API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–æ–∫ (–ª–∏–¥–æ–≤) —Å –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —Å–∞–π—Ç–∞. –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞—è–≤–∫–∏ –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏: –∑–∞—è–≤–∫–∏ –ø–æ —É—Å–ª—É–≥–∞–º, –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å, –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ.

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

- ‚úÖ **–¢—Ä–∏ —Ç–∏–ø–∞ –∑–∞—è–≤–æ–∫**: —É—Å–ª—É–≥–∞, –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å, –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ
- ‚úÖ **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ UTM –º–µ—Ç–æ–∫
- ‚úÖ **–ì–∏–±–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**: –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏ –∏–º–µ–Ω–∏ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ

---

## üì° Endpoint –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏

### URL

```http
POST /api/website/leads/
```

### –ë–∞–∑–æ–≤—ã–µ URL

```
Production: https://api.911.ru/api/website/leads/
Development: http://localhost:8001/api/website/leads/
```

### Headers

```http
Content-Type: application/json
```

---

## üè∑Ô∏è –¢–∏–ø—ã –∑–∞—è–≤–æ–∫

| –¢–∏–ø | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|-----|----------|----------|---------------------|
| `service` | –ó–∞—è–≤–∫–∞ –ø–æ —É—Å–ª—É–≥–µ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ | –ö–ª–∏–µ–Ω—Ç —Ö–æ—á–µ—Ç –∑–∞–∫–∞–∑–∞—Ç—å —É—Å–ª—É–≥—É | –§–æ—Ä–º—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö —É—Å–ª—É–≥, –∫–Ω–æ–ø–∫–∏ "–ó–∞–∫–∞–∑–∞—Ç—å" |
| `feedback` | –ó–∞—è–≤–∫–∞ —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏ –∏–ª–∏ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑—å—é | –ö–ª–∏–µ–Ω—Ç —Ö–æ—á–µ—Ç –æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤ –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ | –§–æ—Ä–º—ã –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏, —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ |
| `partnership` | –ó–∞—è–≤–∫–∞ –Ω–∞ –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ | –ö–æ–º–ø–∞–Ω–∏—è —Ö–æ—á–µ—Ç —Å—Ç–∞—Ç—å –ø–∞—Ä—Ç–Ω–µ—Ä–æ–º | –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–∞, —Ñ–æ—Ä–º–∞ –¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ |

**–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `service` (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω)

---

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–∞

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –í–∞–ª–∏–¥–∞—Ü–∏—è |
|------|-----|----------|-----------|
| `name` | string | –ò–º—è –∫–ª–∏–µ–Ω—Ç–∞ | –ú–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞, –º–∞–∫—Å–∏–º—É–º 100 |
| `phone` | string | –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ | 10-12 —Ü–∏—Ñ—Ä (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç—ã: +7..., 8..., –∏ —Ç.–¥.) |

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–æ–ª—è

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|------|-----|----------|--------|
| `email` | string | Email –∞–¥—Ä–µ—Å | `ivan@example.com` |
| `city` | integer | ID –≥–æ—Ä–æ–¥–∞ | `1` |
| `service` | integer | ID —É—Å–ª—É–≥–∏ | `2` |
| `message` | string | –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ | `"–ù—É–∂–µ–Ω —à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∑–∞–≤—Ç—Ä–∞ —É—Ç—Ä–æ–º"` |
| `lead_type` | string | –¢–∏–ø –∑–∞—è–≤–∫–∏ | `"service"`, `"feedback"`, `"partnership"` |
| `page_url` | string (URL) | **–ü–æ–ª–Ω—ã–π URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã** —Å –∫–æ—Ç–æ—Ä–æ–π —Å–æ–∑–¥–∞–Ω–∞ –∑–∞—è–≤–∫–∞ | `"https://911.ru/moskva/shinomontazh/?utm_source=google&utm_medium=cpc"` |
| `source_page` | string | –ü—É—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–±–µ–∑ –¥–æ–º–µ–Ω–∞) | `"/moskva/shinomontazh/"` |
| `utm_source` | string | UTM –º–µ—Ç–∫–∞: –∏—Å—Ç–æ—á–Ω–∏–∫ | `"google"` |
| `utm_medium` | string | UTM –º–µ—Ç–∫–∞: –∫–∞–Ω–∞–ª | `"cpc"` |
| `utm_campaign` | string | UTM –º–µ—Ç–∫–∞: –∫–∞–º–ø–∞–Ω–∏—è | `"winter2025"` |

### ‚ö†Ô∏è –í–∞–∂–Ω–æ –ø—Ä–æ `page_url`

–ü–æ–ª–µ `page_url` –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å **–ø–æ–ª–Ω—ã–π URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã**, –≤–∫–ª—é—á–∞—è:
- –ü—Ä–æ—Ç–æ–∫–æ–ª (`https://`)
- –î–æ–º–µ–Ω (`911.ru`)
- –ü—É—Ç—å (`/moskva/shinomontazh/`)
- Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (`?utm_source=google&utm_medium=cpc`)

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞ –±—ç–∫–µ–Ω–¥–µ:
- –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å –∫–∞–∫–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏—à–ª–∞ –∑–∞—è–≤–∫–∞
- –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å UTM –º–µ—Ç–∫–∏
- –ü–æ–Ω–∏–º–∞—Ç—å –∫–∞–∫–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- –°—Ç—Ä–æ–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º —Ç—Ä–∞—Ñ–∏–∫–∞

**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ:**

```javascript
// –í –±—Ä–∞—É–∑–µ—Ä–µ
const pageUrl = window.location.href; // –ü–æ–ª–Ω—ã–π URL —Å query –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

// –í Next.js (SSR)
const pageUrl = `${req.protocol}://${req.get('host')}${req.originalUrl}`;
```

---

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –ó–∞—è–≤–∫–∞ –ø–æ —É—Å–ª—É–≥–µ (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å)

```json
{
  "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "phone": "+79991234567"
}
```

### 2. –ó–∞—è–≤–∫–∞ –ø–æ —É—Å–ª—É–≥–µ (–ø–æ–ª–Ω—ã–π –∑–∞–ø—Ä–æ—Å)

```json
{
  "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "phone": "+79991234567",
  "email": "ivan@example.com",
  "city": 1,
  "service": 2,
  "message": "–ù—É–∂–µ–Ω —à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ –∑–∞–≤—Ç—Ä–∞ —É—Ç—Ä–æ–º",
  "lead_type": "service",
  "page_url": "https://911.ru/moskva/shinomontazh/?utm_source=google&utm_medium=cpc&utm_campaign=winter2025",
  "source_page": "/moskva/shinomontazh/",
  "utm_source": "google",
  "utm_medium": "cpc",
  "utm_campaign": "winter2025"
}
```

### 3. –ó–∞—è–≤–∫–∞ —Å –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑—å—é

```json
{
  "name": "–ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤",
  "phone": "+79997654321",
  "email": "petr@example.com",
  "message": "–•–æ—á—É –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å —É–ª—É—á—à–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞. –û—á–µ–Ω—å –ø–æ–Ω—Ä–∞–≤–∏–ª—Å—è –≤—ã–µ–∑–¥–Ω–æ–π —à–∏–Ω–æ–º–æ–Ω—Ç–∞–∂!",
  "lead_type": "feedback",
  "page_url": "https://911.ru/contacts/",
  "source_page": "/contacts/"
}
```

### 4. –ó–∞—è–≤–∫–∞ –Ω–∞ –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ

```json
{
  "name": "–û–û–û –ö–æ–º–ø–∞–Ω–∏—è",
  "phone": "+79998887766",
  "email": "partner@example.com",
  "message": "–ò–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ. –ú—ã —Ä–∞–±–æ—Ç–∞–µ–º –≤ —Å—Ñ–µ—Ä–µ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞.",
  "lead_type": "partnership",
  "page_url": "https://911.ru/partnership/?ref=partner_site",
  "source_page": "/partnership/"
}
```

---

## üîß –ü–ª–∞–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å TypeScript —Ç–∏–ø—ã

```typescript
// types/lead.ts

export type LeadType = 'service' | 'feedback' | 'partnership';

export interface CreateLeadRequest {
  // –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ
  name: string;
  phone: string;
  
  // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ
  email?: string;
  city?: number;
  service?: number;
  message?: string;
  lead_type?: LeadType;
  page_url?: string;
  source_page?: string;
  utm_source?: string;
  utm_medium?: string;
  utm_campaign?: string;
}

export interface CreateLeadResponse {
  id: number;
  name: string;
  phone: string;
  email: string | null;
  city: number | null;
  city_title: string | null;
  service: number | null;
  service_title: string | null;
  message: string;
  lead_type: LeadType;
  lead_type_display: string;
  page_url: string | null;
  source_page: string;
  utm_source: string;
  utm_medium: string;
  utm_campaign: string;
  status: 'new' | 'processing' | 'converted' | 'rejected';
  status_display: string;
  created_at: string;
  processed_at: string | null;
}
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å API —Å–µ—Ä–≤–∏—Å

```typescript
// services/leadService.ts

import axios from 'axios';
import { CreateLeadRequest, CreateLeadResponse } from '@/types/lead';

const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8001';
const API_ENDPOINT = `${API_BASE_URL}/api/website/leads/`;

export const leadService = {
  /**
   * –°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É
   */
  async createLead(data: CreateLeadRequest): Promise<CreateLeadResponse> {
    try {
      const response = await axios.post<CreateLeadResponse>(
        API_ENDPOINT,
        data,
        {
          headers: {
            'Content-Type': 'application/json',
          },
        }
      );
      
      return response.data;
    } catch (error) {
      if (axios.isAxiosError(error)) {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
        if (error.response?.status === 400) {
          throw new Error(
            `–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏: ${JSON.stringify(error.response.data)}`
          );
        }
        // Rate limiting
        if (error.response?.status === 429) {
          throw new Error('–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
        }
      }
      throw error;
    }
  },
  
  /**
   * –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–¥–ª—è page_url)
   */
  getCurrentPageUrl(): string {
    if (typeof window !== 'undefined') {
      return window.location.href;
    }
    return '';
  },
  
  /**
   * –ü–æ–ª—É—á–∏—Ç—å –ø—É—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–¥–ª—è source_page)
   */
  getCurrentPagePath(): string {
    if (typeof window !== 'undefined') {
      return window.location.pathname;
    }
    return '';
  },
  
  /**
   * –ü–æ–ª—É—á–∏—Ç—å UTM –º–µ—Ç–∫–∏ –∏–∑ URL
   */
  getUtmParams(): {
    utm_source?: string;
    utm_medium?: string;
    utm_campaign?: string;
  } {
    if (typeof window === 'undefined') {
      return {};
    }
    
    const params = new URLSearchParams(window.location.search);
    
    return {
      utm_source: params.get('utm_source') || undefined,
      utm_medium: params.get('utm_medium') || undefined,
      utm_campaign: params.get('utm_campaign') || undefined,
    };
  },
};
```

### –®–∞–≥ 3: –°–æ–∑–¥–∞—Ç—å —Ö—É–∫ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞—è–≤–∫–∏

```typescript
// hooks/useCreateLead.ts

import { useState } from 'react';
import { leadService, CreateLeadRequest, CreateLeadResponse } from '@/services/leadService';

export function useCreateLead() {
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [success, setSuccess] = useState(false);
  const [lead, setLead] = useState<CreateLeadResponse | null>(null);
  
  const createLead = async (data: CreateLeadRequest) => {
    setLoading(true);
    setError(null);
    setSuccess(false);
    
    try {
      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º page_url –∏ UTM –º–µ—Ç–∫–∏, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω—ã
      const enrichedData: CreateLeadRequest = {
        ...data,
        page_url: data.page_url || leadService.getCurrentPageUrl(),
        source_page: data.source_page || leadService.getCurrentPagePath(),
        ...(data.utm_source ? {} : leadService.getUtmParams()),
      };
      
      const response = await leadService.createLead(enrichedData);
      
      setLead(response);
      setSuccess(true);
      
      return response;
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞';
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  };
  
  const reset = () => {
    setError(null);
    setSuccess(false);
    setLead(null);
  };
  
  return {
    createLead,
    loading,
    error,
    success,
    lead,
    reset,
  };
}
```

### –®–∞–≥ 4: –°–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ñ–æ—Ä–º—ã –∑–∞—è–≤–∫–∏

```tsx
// components/LeadForm.tsx

'use client';

import { useState, FormEvent } from 'react';
import { useCreateLead } from '@/hooks/useCreateLead';
import { LeadType } from '@/types/lead';

interface LeadFormProps {
  leadType?: LeadType;
  cityId?: number;
  serviceId?: number;
  onSuccess?: () => void;
}

export function LeadForm({
  leadType = 'service',
  cityId,
  serviceId,
  onSuccess,
}: LeadFormProps) {
  const { createLead, loading, error, success } = useCreateLead();
  
  const [formData, setFormData] = useState({
    name: '',
    phone: '',
    email: '',
    message: '',
  });
  
  const handleSubmit = async (e: FormEvent) => {
    e.preventDefault();
    
    try {
      await createLead({
        ...formData,
        lead_type: leadType,
        city: cityId,
        service: serviceId,
      });
      
      // –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É
      setFormData({
        name: '',
        phone: '',
        email: '',
        message: '',
      });
      
      // –í—ã–∑–≤–∞—Ç—å callback
      if (onSuccess) {
        onSuccess();
      }
    } catch (err) {
      // –û—à–∏–±–∫–∞ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞ –≤ —Ö—É–∫–µ
      console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏:', err);
    }
  };
  
  if (success) {
    return (
      <div className="lead-form-success">
        <h3>–°–ø–∞—Å–∏–±–æ!</h3>
        <p>–í–∞—à–∞ –∑–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞. –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.</p>
      </div>
    );
  }
  
  return (
    <form onSubmit={handleSubmit} className="lead-form">
      <div className="form-group">
        <label htmlFor="name">–ò–º—è *</label>
        <input
          id="name"
          type="text"
          value={formData.name}
          onChange={(e) => setFormData({ ...formData, name: e.target.value })}
          required
          minLength={2}
          maxLength={100}
        />
      </div>
      
      <div className="form-group">
        <label htmlFor="phone">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
        <input
          id="phone"
          type="tel"
          value={formData.phone}
          onChange={(e) => setFormData({ ...formData, phone: e.target.value })}
          required
          placeholder="+7 (999) 123-45-67"
        />
      </div>
      
      <div className="form-group">
        <label htmlFor="email">Email</label>
        <input
          id="email"
          type="email"
          value={formData.email}
          onChange={(e) => setFormData({ ...formData, email: e.target.value })}
        />
      </div>
      
      <div className="form-group">
        <label htmlFor="message">–°–æ–æ–±—â–µ–Ω–∏–µ</label>
        <textarea
          id="message"
          value={formData.message}
          onChange={(e) => setFormData({ ...formData, message: e.target.value })}
          rows={4}
        />
      </div>
      
      {error && (
        <div className="form-error">
          {error}
        </div>
      )}
      
      <button type="submit" disabled={loading}>
        {loading ? '–û—Ç–ø—Ä–∞–≤–∫–∞...' : '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É'}
      </button>
    </form>
  );
}
```

### –®–∞–≥ 5: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö

#### –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —É—Å–ª—É–≥–∏:

```tsx
// pages/[city]/[service]/page.tsx

import { LeadForm } from '@/components/LeadForm';

export default function ServicePage({ params }) {
  const { city, service } = params;
  
  // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏
  const serviceData = await getServiceData(city, service);
  
  return (
    <div>
      <h1>{serviceData.service.title}</h1>
      
      {/* –§–æ—Ä–º–∞ –∑–∞—è–≤–∫–∏ –ø–æ —É—Å–ª—É–≥–µ */}
      <LeadForm
        leadType="service"
        cityId={serviceData.city.id}
        serviceId={serviceData.service.id}
        onSuccess={() => {
          // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å—é
          // –ò–ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ –≤ –∞–Ω–∞–ª–∏—Ç–∏–∫—É
        }}
      />
    </div>
  );
}
```

#### –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤:

```tsx
// pages/contacts/page.tsx

import { LeadForm } from '@/components/LeadForm';

export default function ContactsPage() {
  return (
    <div>
      <h1>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h1>
      
      {/* –§–æ—Ä–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ */}
      <LeadForm
        leadType="feedback"
        onSuccess={() => {
          alert('–°–ø–∞—Å–∏–±–æ –∑–∞ –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å!');
        }}
      />
    </div>
  );
}
```

#### –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–∞:

```tsx
// pages/partnership/page.tsx

import { LeadForm } from '@/components/LeadForm';

export default function PartnershipPage() {
  return (
    <div>
      <h1>–ü–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ</h1>
      
      {/* –§–æ—Ä–º–∞ –∑–∞—è–≤–∫–∏ –Ω–∞ –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ */}
      <LeadForm
        leadType="partnership"
        onSuccess={() => {
          // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        }}
      />
    </div>
  );
}
```

---

## ‚ö†Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ | –ß—Ç–æ –¥–µ–ª–∞—Ç—å |
|-----|----------|------------|
| `201` | –ó–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞ | –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ |
| `400` | –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö | –ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é |
| `429` | –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ | –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ "–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ" |
| `500` | –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ | –ü–æ–∫–∞–∑–∞—Ç—å –æ–±—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ |

### –ü—Ä–∏–º–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

```typescript
try {
  await createLead(data);
} catch (error) {
  if (axios.isAxiosError(error) && error.response?.status === 400) {
    const validationErrors = error.response.data;
    
    // validationErrors –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—ä–µ–∫—Ç–æ–º —Å –ø–æ–ª—è–º–∏:
    // {
    //   "name": ["–ò–º—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞"],
    //   "phone": ["–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ—Ç 10 –¥–æ 12 —Ü–∏—Ñ—Ä"]
    // }
    
    Object.keys(validationErrors).forEach((field) => {
      // –ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É —Ä—è–¥–æ–º —Å –ø–æ–ª–µ–º —Ñ–æ—Ä–º—ã
      setFieldError(field, validationErrors[field][0]);
    });
  }
}
```

---

## ‚ùì FAQ

### Q: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ª–∏ —É–∫–∞–∑—ã–≤–∞—Ç—å `page_url`?

**A:** –ù–µ—Ç, –ø–æ–ª–µ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ. –ù–æ **—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è** –≤—Å–µ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –µ–≥–æ, —á—Ç–æ–±—ã –Ω–∞ –±—ç–∫–µ–Ω–¥–µ –º–æ–∂–Ω–æ –±—ã–ª–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∑–∞—è–≤–æ–∫. –•—É–∫ `useCreateLead` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç `page_url`, –µ—Å–ª–∏ –æ–Ω –Ω–µ —É–∫–∞–∑–∞–Ω.

### Q: –ß—Ç–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—à–µ–ª –ø–æ —Å—Å—ã–ª–∫–µ —Å UTM –º–µ—Ç–∫–∞–º–∏?

**A:** UTM –º–µ—Ç–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∏–∑ URL –∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –∑–∞–ø—Ä–æ—Å (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω—ã —è–≤–Ω–æ). –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ `leadService.getUtmParams()`.

### Q: –ú–æ–∂–Ω–æ –ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞—è–≤–∫—É –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è –≥–æ—Ä–æ–¥–∞ –∏ —É—Å–ª—É–≥–∏?

**A:** –î–∞, –ø–æ–ª—è `city` –∏ `service` –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –∑–∞—è–≤–æ–∫ —Ç–∏–ø–∞ `feedback` –∏–ª–∏ `partnership` –æ–Ω–∏ –æ–±—ã—á–Ω–æ –Ω–µ –Ω—É–∂–Ω—ã.

### Q: –ö–∞–∫ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø –∑–∞—è–≤–∫–∏ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ?

**A:** –¢–∏–ø –∑–∞—è–≤–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º:
- –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —É—Å–ª—É–≥–∏ ‚Üí `service`
- –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤/–æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ ‚Üí `feedback`
- –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–∞ ‚Üí `partnership`

### Q: –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–∏–ª –∑–∞—è–≤–∫—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑?

**A:** –ù–∞ –±—ç–∫–µ–Ω–¥–µ –µ—Å—Ç—å rate limiting (5 –∑–∞—è–≤–æ–∫ –≤ —á–∞—Å —Å –æ–¥–Ω–æ–≥–æ IP). –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ –≤–µ—Ä–Ω–µ—Ç—Å—è –æ—à–∏–±–∫–∞ `429`. –ü–æ–∫–∞–∂–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–æ–æ–±—â–µ–Ω–∏–µ "–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ".

### Q: –ù—É–∂–Ω–æ –ª–∏ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ?

**A:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –±–∞–∑–æ–≤—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ –¥–ª—è –ª—É—á—à–µ–≥–æ UX, –Ω–æ –æ—Å–Ω–æ–≤–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ –±—ç–∫–µ–Ω–¥–µ. –ë—ç–∫–µ–Ω–¥ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–ª–µ—Ñ–æ–Ω—ã –≤ –ª—é–±–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (—Å –ø—Ä–æ–±–µ–ª–∞–º–∏, —Å–∫–æ–±–∫–∞–º–∏, –ø–ª—é—Å–æ–º –∏ —Ç.–¥.) –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–ª—å–∫–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–∏—Ñ—Ä.

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- **Swagger UI**: `http://localhost:8001/api/docs/`
- **ReDoc**: `http://localhost:8001/api/redoc/`
- **OpenAPI Schema**: `http://localhost:8001/api/schema/`

---

## üîÑ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –í–µ—Ä—Å–∏—è | –î–∞—Ç–∞ | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|--------|------|-----------|
| 1.0 | 30.12.2025 | –ü–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è. –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∏–ø—ã –∑–∞—è–≤–æ–∫ –∏ –ø–æ–ª–µ page_url |

